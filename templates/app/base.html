{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="description" content="Добро пожаловать!">
    <link rel="shortcut icon" type="image/png" href="{% static 'img/_favicon.ico' %}"/>
    <title>{{ title }}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="{% static 'css/roboto.css' %}" rel="stylesheet">
    <link href="{% static 'tw-elements/dist/css/tw-elements.min.css' %}" rel="stylesheet">
    {% block head %}{% endblock %}
</head>
<body>
<div>
<nav class="flex-no-wrap relative flex w-full items-center justify-between bg-[#FBFBFB] py-2 shadow-md shadow-black/5 dark:bg-neutral-700 dark:shadow-black/10 lg:flex-wrap lg:justify-start lg:py-4">
    <div class="ml-5 flex w-[45%] items-center" data-te-dropdown-ref>
        <div class="relative w-[45%]" data-te-input-wrapper-init id="customItem">
          <input
            type="text"
            class="peer block min-h-[auto] w-full rounded border-0 bg-transparent px-3 py-[0.32rem] leading-[1.6] outline-none transition-all duration-200 ease-linear placeholder:opacity-0 focus:placeholder:opacity-100 peer-focus:text-primary motion-reduce:transition-none dark:text-neutral-200 dark:placeholder:text-neutral-200 dark:peer-focus:text-primary"
            id="exampleFormControlInput6" />
          <label
            for="exampleFormControlInput6"
            class="pointer-events-none absolute left-3 top-0 mb-0 max-w-[80%] origin-[0_0] truncate pt-[0.37rem] leading-[1.6] text-neutral-500 transition-all duration-200 ease-out peer-focus:-translate-y-[0.9rem] peer-focus:scale-[0.8] peer-focus:text-primary peer-data-[te-input-focused]:-translate-y-[0.9rem] peer-data-[te-input-state-active]:-translate-y-[0.9rem] peer-data-[te-input-focused]:scale-[0.8] peer-data-[te-input-state-active]:scale-[0.8] motion-reduce:transition-none dark:text-neutral-200 dark:peer-focus:text-primary"
            >Поиск по сайту
          </label>
        </div>
        <!--Search icon-->
        <span
          class="input-group-text flex items-center whitespace-nowrap rounded px-3 py-1.5 text-center text-base font-normal text-neutral-700 dark:text-neutral-200"
          id="basic-addon2">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 20 20"
            fill="currentColor"
            class="h-5 w-5">
            <path
              fill-rule="evenodd"
              d="M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75 0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z"
              clip-rule="evenodd"></path>
          </svg>
        </span>
    </div>
    <div class="!visible hidden flex-grow basis-[100%] items-center lg:!flex lg:basis-auto" id="navbarSupportedContent1" data-te-collapse-item>
        <!-- Logo -->
        <a class="mb-4 ml-2 mr-5 mt-3 flex items-center text-neutral-900 hover:text-neutral-900 focus:text-neutral-900 dark:text-neutral-200 dark:hover:text-neutral-400 dark:focus:text-neutral-400 lg:mb-0 lg:mt-0">
            {# <img src="{% static 'img/te-transparent-noshadows.webp' %}" style="height: 15px;" alt="TE Logo" loading="lazy" />#}
        </a>
        <!-- Left navigation links -->

    </div>
    <!-- Right elements -->
    <div class="relative flex items-center ">
        <span
            data-te-html="true"
            data-te-toggle="tooltip"
            data-te-placement="top"
            title="{% if user.is_superuser %}Суперпользователь{% else %}<b>Обычный пользователь</b>{% endif %}"
            class="mr-10 inline-block {% if user.is_superuser %}text-danger{% else %}text-secondary-800{% endif %} whitespace-nowrap rounded-[0.27rem] bg-secondary-100 px-[0.65em] pb-[0.25em] pt-[0.35em] text-center align-baseline text-[0.75em] font-bold leading-none"
        >
            {% if request.user.is_authenticated %}
                Пользователь : {{ request.user.last_name  }} {{ request.user.first_name }}
            {% endif %}

        </span>
        <div>
            <!-- Theme dropdown menu -->
            <div class="relative" data-te-dropdown-ref data-te-dropdown-alignment="end">
                <!-- First dropdown trigger -->
                <a
                    class="hidden-arrow mr-4 flex items-center text-neutral-600 transition duration-200 hover:text-neutral-700 hover:ease-in-out focus:text-neutral-700 disabled:text-black/30 motion-reduce:transition-none dark:text-neutral-200 dark:hover:text-neutral-300 dark:focus:text-neutral-300 [&.active]:text-black/90 dark:[&.active]:text-neutral-400"
                    id="dropdownMenuButtonTheme"
                    role="button"
                    aria-label="Theme icon"
                    data-te-dropdown-toggle-ref
                    aria-expanded="false"
                >
                    <!-- Dropdown trigger icon -->
                    <span class="[&>svg]:w-5" id="themeIcon"> </span>
                </a>
                <!-- First dropdown menu -->
                <ul
                    class="absolute z-[1000] float-left m-0 hidden min-w-max list-none overflow-hidden rounded-lg border-none bg-white bg-clip-padding text-left text-base shadow-lg dark:bg-neutral-700 [&[data-te-dropdown-show]]:block"
                    aria-labelledby="dropdownMenuButtonTheme"
                    data-te-dropdown-menu-ref
                >
                    <!-- First dropdown menu items -->
                    <li>
                        <h6 class="block w-full whitespace-nowrap bg-transparent px-4 py-2 text-sm font-semibold text-neutral-500 dark:text-neutral-200">
                            Тема
                        </h6>
                        <a
                            class="block w-full whitespace-nowrap bg-transparent px-3 py-2 text-sm font-normal text-neutral-700 hover:bg-neutral-100 focus:bg-neutral-200 focus:outline-none active:text-neutral-800 active:no-underline disabled:pointer-events-none disabled:bg-transparent disabled:text-neutral-400 dark:text-neutral-100 dark:hover:bg-neutral-600 focus:dark:bg-neutral-600"
                            id="theme-switcher"
                            data-theme="dark"
                            data-te-dropdown-item-ref=""
                        >
                            <div class="pointer-events-none">
                                <div class="-mt-1 inline-block w-[24px] text-center align-middle" data-theme-icon="dark">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="inline-block h-4 w-4">
                                        <path
                                            fill-rule="evenodd"
                                            d="M9.528 1.718a.75.75 0 01.162.819A8.97 8.97 0 009 6a9 9 0 009 9 8.97 8.97 0 003.463-.69.75.75 0 01.981.98 10.503 10.503 0 01-9.694 6.46c-5.799 0-10.5-4.701-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 01.818.162z"
                                            clip-rule="evenodd"
                                        ></path>
                                    </svg>
                                </div>
                                <span data-theme-name="dark">Dark</span>
                            </div>
                        </a>
                    </li>
                    <li>
                        <a
                            class="block w-full whitespace-nowrap bg-transparent px-3 py-2 text-sm font-normal text-neutral-700 hover:bg-neutral-100 focus:bg-neutral-200 focus:outline-none active:text-neutral-800 active:no-underline disabled:pointer-events-none disabled:bg-transparent disabled:text-neutral-400 dark:text-neutral-100 dark:hover:bg-neutral-600 focus:dark:bg-neutral-600"
                            id="theme-switcher"
                            data-theme="light"
                            data-te-dropdown-item-ref=""
                        >
                            <div class="pointer-events-none">
                                <div class="inline-block w-[24px] text-center align-middle" data-theme-icon="light">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="inline-block h-5 w-5">
                                        <path
                                            d="M12 2.25a.75.75 0 01.75.75v2.25a.75.75 0 01-1.5 0V3a.75.75 0 01.75-.75zM7.5 12a4.5 4.5 0 119 0 4.5 4.5 0 01-9 0zM18.894 6.166a.75.75 0 00-1.06-1.06l-1.591 1.59a.75.75 0 101.06 1.061l1.591-1.59zM21.75 12a.75.75 0 01-.75.75h-2.25a.75.75 0 010-1.5H21a.75.75 0 01.75.75zM17.834 18.894a.75.75 0 001.06-1.06l-1.59-1.591a.75.75 0 10-1.061 1.06l1.59 1.591zM12 18a.75.75 0 01.75.75V21a.75.75 0 01-1.5 0v-2.25A.75.75 0 0112 18zM7.758 17.303a.75.75 0 00-1.061-1.06l-1.591 1.59a.75.75 0 001.06 1.061l1.591-1.59zM6 12a.75.75 0 01-.75.75H3a.75.75 0 010-1.5h2.25A.75.75 0 016 12zM6.697 7.757a.75.75 0 001.06-1.06l-1.59-1.591a.75.75 0 00-1.061 1.06l1.59 1.591z"
                                        ></path>
                                    </svg>
                                </div>
                                <span data-theme-name="light">Light</span>
                            </div>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
        <!-- Main menu -->
        <div>
            <a
                class="hidden-arrow b mr-4 flex items-center  text-neutral-600 transition duration-200 hover:text-neutral-700 hover:ease-in-out focus:text-neutral-700 disabled:text-black/30 motion-reduce:transition-none dark:text-neutral-200 dark:hover:text-neutral-300 dark:focus:text-neutral-300 [&.active]:text-black/90 dark:[&.active]:text-neutral-400"
                id="dropdownMenuButton1"
                role="button"
                data-te-sidenav-toggle-ref
                data-te-target="#sidenav-8"
                aria-controls="#sidenav-8"
                aria-haspopup="true"
                aria-expanded="false"
            >
                <!-- Dropdown trigger icon -->
                <span class="[&>svg]:w-5">
                   <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                      <rect width="24" height="24" fill="none"></rect>
                      <g fill="none" stroke="currentColor">
                         <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.009m3.996 0h.008m3.978 0H16"></path>
                         <circle cx="12" cy="12" r="10" stroke-width="1.5"></circle>
                      </g>
                   </svg>
                </span>
            </a>
        </div>
    </div>
</nav>
<!-- Sidenav -->
<nav
    id="sidenav-8"
    class="absolute left-0 top-0 z-[1035] h-full w-60 -translate-x-full overflow-hidden bg-white shadow-[0_4px_12px_0_rgba(0,0,0,0.07),_0_2px_4px_rgba(0,0,0,0.05)] data-[te-sidenav-hidden='false']:translate-x-0 dark:bg-zinc-800"
    data-te-sidenav-init
    data-te-sidenav-hidden="true"
    data-te-sidenav-position="absolute"
    data-te-sidenav-accordion="true">
    <a class="mb-3 flex items-center justify-center border-b-2 border-solid border-gray-100 py-6 outline-none" href="" data-te-ripple-init data-te-ripple-color="primary">
{#        <img id="te-logo" class="mr-2 w-5" src="https://tecdn.b-cdn.net/img/logo/te-transparent-noshadows.png" alt="TE Logo" draggable="false" />#}
        <span>Дашборд</span>
    </a>
    <ul class="relative m-0 list-none px-[0.2rem] pb-12" data-te-sidenav-menu-ref>
        <li class="relative">
            <a
                href="{% url 'app:index' %}"
                class="flex cursor-pointer items-center truncate rounded-[5px] px-6 py-[0.45rem] text-[0.85rem] text-gray-600 outline-none transition duration-300 ease-linear hover:bg-slate-50 hover:text-inherit hover:outline-none focus:bg-slate-50 focus:text-inherit focus:outline-none active:bg-slate-50 active:text-inherit active:outline-none data-[te-sidenav-state-active]:text-inherit data-[te-sidenav-state-focus]:outline-none motion-reduce:transition-none dark:text-gray-300 dark:hover:bg-white/10 dark:focus:bg-white/10 dark:active:bg-white/10"
                data-te-sidenav-link-ref>
                <span class="mr-4 [&>svg]:h-3.5 [&>svg]:w-3.5 [&>svg]:text-gray-400 dark:[&>svg]:text-gray-300">
                    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.235 2.374c-.368.152-.697.482-1.356 1.14c-.659.66-.989.989-1.14 1.356a2 2 0 0 0 0 1.531c.151.368.48.697 1.14 1.356c.658.659.988.989 1.356 1.14a2 2 0 0 0 1.53 0c.368-.151.697-.48 1.356-1.14c.66-.659.988-.988 1.14-1.356a2 2 0 0 0 0-1.53c-.152-.368-.48-.697-1.14-1.356c-.659-.66-.988-.989-1.356-1.141a2 2 0 0 0-1.53 0M4.87 8.738c-.367.152-.697.481-1.355 1.14c-.66.66-.989.989-1.141 1.356a2 2 0 0 0 0 1.531c.152.368.482.697 1.14 1.356c.66.659.989.988 1.356 1.14a2 2 0 0 0 1.531 0c.368-.152.697-.481 1.356-1.14c.66-.659.988-.988 1.14-1.356a2 2 0 0 0 0-1.53c-.152-.368-.48-.698-1.14-1.357c-.659-.659-.988-.988-1.356-1.14a2 2 0 0 0-1.53 0m11.372 1.14c-.659.66-.988.989-1.14 1.356a2 2 0 0 0 0 1.531c.152.368.481.697 1.14 1.356c.659.659.989.988 1.356 1.14a2 2 0 0 0 1.53 0c.368-.152.698-.481 1.357-1.14c.659-.659.987-.988 1.14-1.356a2 2 0 0 0 0-1.53c-.153-.368-.481-.698-1.14-1.357c-.66-.659-.989-.988-1.356-1.14a2 2 0 0 0-1.531 0c-.367.152-.697.481-1.356 1.14m-5.008 5.224c-.368.152-.697.482-1.356 1.14c-.659.66-.989.989-1.14 1.357a2 2 0 0 0 0 1.53c.151.368.48.697 1.14 1.356c.658.659.988.989 1.356 1.14a2 2 0 0 0 1.53 0c.368-.151.697-.48 1.356-1.14c.66-.659.988-.988 1.14-1.356c.203-.49.203-1.04 0-1.53c-.152-.368-.48-.698-1.14-1.356c-.659-.66-.988-.989-1.356-1.141a2 2 0 0 0-1.53 0"/></svg>
                </span>
                <span>Главная страница</span>
            </a>
        </li>
        {% for tag, modules in modules_dict.items %}
            <li class="relative pt-4">
                <span class="px-6 py-4 text-[0.6rem] font-bold uppercase text-gray-600 dark:text-gray-400">{{ tag }}</span>
            </li>
            {% for module_dict in modules %}
                {% if module_dict.module.name == 'Уведомления' %}
                    <li class="relative">
                        <a
                            href="{{ module_dict.module.url }}"
                            class="flex cursor-pointer items-center truncate rounded-[5px] px-6 py-[0.45rem] text-[0.85rem] text-gray-600 outline-none transition duration-300 ease-linear hover:bg-slate-50 hover:text-inherit hover:outline-none focus:bg-slate-50 focus:text-inherit focus:outline-none active:bg-slate-50 active:text-inherit active:outline-none data-[te-sidenav-state-active]:text-inherit data-[te-sidenav-state-focus]:outline-none motion-reduce:transition-none dark:text-gray-300 dark:hover:bg-white/10 dark:focus:bg-white/10 dark:active:bg-white/10"
                            data-te-sidenav-link-ref>
                            <span class="mr-4 [&>svg]:h-3.5 [&>svg]:w-3.5 [&>svg]:text-gray-400 dark:[&>svg]:text-gray-300">
                                <svg
                                  xmlns="http://www.w3.org/2000/svg"
                                  viewBox="0 0 24 24"
                                  fill="currentColor"
                                  class="h-5 w-5">
                                  <path
                                    fill-rule="evenodd"
                                    d="M5.25 9a6.75 6.75 0 0113.5 0v.75c0 2.123.8 4.057 2.118 5.52a.75.75 0 01-.297 1.206c-1.544.57-3.16.99-4.831 1.243a3.75 3.75 0 11-7.48 0 24.585 24.585 0 01-4.831-1.244.75.75 0 01-.298-1.205A8.217 8.217 0 005.25 9.75V9zm4.502 8.9a2.25 2.25 0 104.496 0 25.057 25.057 0 01-4.496 0z"
                                    clip-rule="evenodd"></path>
                                </svg>
                            </span>
                            {% if notification_len %}
                            <span
                                class="absolute -mt-4 ml-2.5 rounded-full bg-danger px-[0.35em] py-[0.15em] text-[0.6rem] font-bold leading-none text-white"
                                >{{ notification_len }}</span
                            >
                            <span>{{ module_dict.module }}</span>
                            {% else %}
                            <span>{{ module_dict.module }}</span>
                            {% endif %}
                        </a>
                    </li>
                {% else %}
                    <li class="relative">
                        <a
                            href="{{ module_dict.module.url }}"
                            class="flex cursor-pointer items-center truncate rounded-[5px] px-6 py-[0.45rem] text-[0.85rem] text-gray-600 outline-none transition duration-300 ease-linear hover:bg-slate-50 hover:text-inherit hover:outline-none focus:bg-slate-50 focus:text-inherit focus:outline-none active:bg-slate-50 active:text-inherit active:outline-none data-[te-sidenav-state-active]:text-inherit data-[te-sidenav-state-focus]:outline-none motion-reduce:transition-none dark:text-gray-300 dark:hover:bg-white/10 dark:focus:bg-white/10 dark:active:bg-white/10"
                            data-te-sidenav-link-ref>
                            <span class="mr-4 [&>svg]:h-3.5 [&>svg]:w-3.5 [&>svg]:text-gray-400 dark:[&>svg]:text-gray-300">
                                {{ module_dict.module.icon|safe }}
                            </span>
                            <span>{{ module_dict.module }}</span>
                        </a>
                    </li>
                {% endif %}
            {% endfor %}
        {% endfor %}
    </ul>
    <ul class="relative m-0 list-none px-[0.2rem] pb-12" data-te-sidenav-menu-ref>
        <li class="relative">
            <a
                href="{% url 'basic_auth:logout' %}"
                class="flex cursor-pointer items-center truncate rounded-[5px] px-6 py-[0.45rem] text-[0.85rem] text-gray-600 outline-none transition duration-300 ease-linear hover:bg-slate-50 hover:text-inherit hover:outline-none focus:bg-slate-50 focus:text-inherit focus:outline-none active:bg-slate-50 active:text-inherit active:outline-none data-[te-sidenav-state-active]:text-inherit data-[te-sidenav-state-focus]:outline-none motion-reduce:transition-none dark:text-gray-300 dark:hover:bg-white/10 dark:focus:bg-white/10 dark:active:bg-white/10"
                data-te-sidenav-link-ref>
                <span class="mr-4 [&>svg]:h-3.5 [&>svg]:w-3.5 [&>svg]:text-gray-400 dark:[&>svg]:text-gray-300">
                    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24"> <path fill="currentColor" d="M3 21V3h9v2H5v14h7v2zm13-4l-1.375-1.45l2.55-2.55H9v-2h8.175l-2.55-2.55L16 7l5 5z"></path></svg>
                </span>
                <span>Выйти</span>
            </a>
        </li>
    </ul>
</nav>
</div>

<div>{% block body %}{% endblock %}</div>
</body>
    <script src="{% static 'tw-elements/dist/js/tw-elements.umd.min.js' %}" type="text/javascript"></script>
    <script src="{% static 'js/theme.js' %}"  type="text/javascript"></script>
    {% block script %}{% endblock %}
<script>
const asyncFilter = async (query) => {
    const url = `{% url 'api_v1:modules' %}?search=${query}`;
    const response = await fetch(url);
    const data = await response.json();
    return data.result;
};
const customFilter = (value) => {
  return customData.filter((item) => {
    return item.title.toLowerCase().startsWith(value.toLowerCase());
  });
};
const customItem = document.querySelector('#customItem');
new te.Autocomplete(customItem, {
  filter: asyncFilter,
  threshold: 2,
  displayValue: (value) => value.name,
  itemContent: (result) => {
    return `
    <div class="flex flex-col">
      <div class="font-medium"><a href="${result.url}">${result.name}</a></div>
      <div class="text-[0.8rem] whitespace-normal">
           <a
              href="${result.url}"
              class="underline decoration-transparent transition duration-300 ease-in-out hover:decoration-inherit"
              >${result.description}
            </a>
      </div>
    </div>
  `;
  },
});
</script>
</html>